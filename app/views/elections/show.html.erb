<%
election ||= @election
level ||= @level || election.level
user ||= @user
-%>
<%= render 'levels/breadcrumb', { level: level } %>
<h1><%= level.name %> election: <%= election.name %></h1>
<%

if election.url?
  %><p>Weblink: <%= link_to election.url, election.url %></p>
<%
end

if election.start_on?
  %><p>Begins on <%= election.start_on.to_datetime.to_s(:simple_date) %></p>
<%
end

if election.end_on?
  %><p>Ends on <%= election.end_on.to_datetime.to_s(:simple_date) %></p>
<%
end

if election.description?
  %><p><%= election.description %></p>
<%
end


content_for(:other_sections) do
  %>
<section><h2><%= link_to 'Ballots', (election.items_for_path << :ballots) %></h2>
<ul>
<%
  election.ballots.each do |ballot|
    %><%= render 'ballots/list_item', { ballot: ballot, user: user } %><%
  end
  %></ul>
</section>
<%
end

if user
  if election.has_authority_for_user_to?(user, :can_update)
    add_submenu_item(title: 'Edit Election', path: edit_level_election_path(level, election))
  end
  if election.has_authority_for_user_to?(user, :can_delete)
    add_submenu_item(title: 'Delete Election',
      path: delete_level_election_path(level, election),
      attrs: { data: { confirm: 'Are you sure?' }, method: :delete }
    )
  end
  if user.has_authority_for_area(Election.authority_area, :can_create)
    add_submenu_item(title: 'New Election', path: new_level_election_path(level))
  end
  if user.has_authority_for_area(Ballot.authority_area, :can_create)
    add_submenu_item(title: 'Generate Ballots', path: ballot_maker_level_election_path(level, election))
    add_submenu_item(title: 'Add Ballot', path: new_level_election_ballot_path(level, election))
  end
end

-%>
